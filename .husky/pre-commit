# Run secretlint to scan for exposed secrets in staged files
echo "ğŸ” Scanning staged files for secrets..."
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -v '^$')
if [ -n "$STAGED_FILES" ]; then
  echo "$STAGED_FILES" | xargs npx secretlint || {
    echo "âŒ Secret scan failed! Please remove any secrets before committing."
    echo "ğŸ’¡ If this is a false positive, you can add the file pattern to .secretlintrc.json allowsPatterns"
    exit 1
  }
fi

# Run lint-staged for formatting and linting
npx lint-staged
